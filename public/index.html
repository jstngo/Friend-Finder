<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>

	<form id="insertForm" action="/insert" method="POST">
	<form id="deleteForm" action="/delete" method="delete">

		<!-- when you hit the button 

			it makes a req.query object 

				the keys are the name attributes of the form elements

					the values of those keys are whatever the user puts down -->

		<input type="text" name="pres_name" placeholder="put a name">
		<button>insert the president</button>
	</form>

	<ul></ul>

	<h2>update</h2>
	<form action="/update?_method=PUT" method="POST">

		<!-- when you hit the button 

			it makes a req.query object 

				the keys are the name attributes of the form elements

					the values of those keys are whatever the user puts down -->

		<input type="text" name="pres_name" placeholder="put new name">
		<input type="text" name="id" placeholder="put in a president id">
		<button>update the president</button>
	</form>

	<script
	  src="https://code.jquery.com/jquery-3.3.1.min.js"
	  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
	  crossorigin="anonymous"></script>
	<script type="text/javascript">
		displayPresidents();

		$("#insertForm button").on('click', insertPresident);
		$("#deleteForm button").on('click', deletePresident());

		function displayPresidents(){
			$.ajax({
				url: '/presidents',
				method: 'GET'
			}).then(function(res){
				for (var i=0; i<res.length; i++){
					var li = $('<li>');
					li.text(res[i]['pres_name']);

					var f = $('<form>')
					f.attr('action', '/delete?_method=DELETE');
					f.attr('method', 'POST');
						var inp = $('<input>');
							inp.attr('type', 'hidden');
							inp.attr('name', 'id');
							inp.attr('value', res[i].id)
						var b = $('<button>').text('delete');

					f.append(inp, b);

					li.append(f)
					$('ul').append(li);
				}
				// $('div').text(JSON.stringify(res));
			})
		}

		function insertPresident(){
			event.preventDefault();
			
			var pn = $("#insertForm input[name=pres_name]").val();

			// in the data: object, I needed to put pres_name as the key because we need req.body.pres_name to exist
			$.ajax({
				url: '/insert',
				method: 'POST',
				data: {pres_name : pn}
			}).then(function(res){
				displayPresidents();
			});
		}
		
		function deletePresident(){
			event.preventDefault();
			
			var pn = $("#deleteForm input[name=pres_name]").val();

			// in the data: object, I needed to put pres_name as the key because we need req.body.pres_name to exist
			$.ajax({
				url: '/delete',
				method: 'delete',
				data: {pres_name : pn}
			}).then(function(res){
				displayPresidents();
			});
		}

	</script>
</body>
</html>